# Tutorial for Markovian Weighted Ensemble Milestoning (M-WEM)

Author: Dhiman Ray

## Installation link: 
https://github.com/dhimanray/MWEM

## Installation Instruction: 
Go to the MWEM source directory (```mwem```) and enter
```
pip install .
```

Please Install MWEM in the same ebvironment where WESTPA 2.0 is installed.

## Requirements ##

Python3 modules

* numpy
* scipy
* WESTPA 2.0
* matplotlib

MD simulation package

* NAMD 2.14

**Note:** M-WEM is implemented using the colvars module in NAMD. Tutorials can be found in the following links:

* NAMD: http://www.ks.uiuc.edu/Training/Tutorials/namd-index.html

* colvars: https://colvars.github.io/colvars-refman-namd/colvars-refman-namd.html

### Relevant pre-print ###
"Markovian Weighted Ensemble Milestoning (M-WEM): Long-time Kinetics from Short Trajectories" Dhiman Ray, Sharon E. Stone, Ioan Andricioaei, J. Chem. Theory Comput. 2022, 18, 1, 79â€“95. doi: https://doi.org/10.1021/acs.jctc.1c00803

## Description
This tutotorial covers M-WEM simulation for the gas phase Alanine dipeptide system described in the paper above.  

## Tutorial Instructions
This directory contains all the files for performing M-WEM simulation of alanine dipeptide and analyze the results. We will perform M-WEM simulation using the $\Phi$ torsion angle of alanine dipeptide as the milestoning reaction coordinate. But both $\Phi$ and $\Psi$ will be used as weighted ensemble progress coordinate to increase sampling in orthogonal directions. There are total 9 milestones places 20 degrees apart along Phi torsion angle which creats 8 cells. The milestone positions are (-80.0, -60.0, -40.0, -20.0, 0.0, 20.0, 40.0, 60.0, 80.0) degrees. There is one cell between each consecutive pair of milestones.

* ```anchors```: This directory contains the milestone cell anchors (pbd structure files). These files can be obtained from a steered MD simulation as well as from any other pathway finding methods. The location of each anchor is approximately at the middle of the cell. But we are going to perform a restrained equilibration anyway before starting our M-WEM runs

* ```template```: This directory is a generic template for M-WEM simulation for any one cell. It contains all necessary files except for the pdb files which are specific to each cell. Also the ```colvars.in``` files have replacable strings which are used by the ```build.py``` script to create cell specific files. More details in the ```README.md``` file within this directory.

* ```build.py```: This python script builds a seperate directory for each cell with appropriate boundaries and anchor file (```cell_0``` through ```cell_7```. (In practical research application, one may find it necessary to add addiional milestones or cells later, manually, if the transition statistics between all consecutive milestone pairs are not adequately sampled.)

* ```sample_propagation```: This directory contains a sample cell (```cell_0```) directory that would be generated by ```build.py```. More details in the ```README.md``` file within ```sample_preparation/cell_0```.

* ```analysis```: This directory contains codes, scripts and jupyter notebook tutorials to analyze M-WEM simulations. More details in the ```README.md``` file within this directory. 

* ```dataset```: As propagating the M-WEM simulation can take several hours, we provided a set of output files in this directory, which can be analyzed to get the thermodynamic and kinetic properties.
